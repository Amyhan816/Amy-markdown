## 对象指针

### 指向对象的指针

```cpp
#include<iostream>
using namespace std;
class Time
{
    public:
int hour;
int minute;
int sec;
void get_time();
};
void Time::get_time()
{
    cout<<hour<<":"<<minute<<":"<<sec<<endl;
}
```

定义指向类对象的指针：

```cpp
Time *pt;
Time t1;
pt=&t1;
```

pt指向Time类对象t1.

```cpp
*pt//t1
(*pt).hour//t1.hour
pt->hour//t1.hour
(*pt).get_time()//t1.get_time
pt->get_time()//t1.get_time
```

可以通过对象指针pt访问对象和对象的公有成员。



### 指向对象成员的指针

#### 指向对象数据成员的指针

```cpp
p1=&t1.hour;//使p1指向t1.hour
cout<<*p1<<endl;//输出t1.hour的值
```

#### 指向对象成员函数的指针

##### 注意：

成员函数和普通函数有一个不同：成员函数属于一个类。

因此，定义成员函数指针变量与普通函数有所区别。

###### 普通函数

```cpp
void(*p)();//p是指向void型函数的指针变量
p=fun;//将fun函数的入口地址赋给指针变量p，p就指向了函数fun
(*p)();//调用fun函数
```

而由于成员函数属于一个类，定义指针变量与上面有所区别

###### 成员函数

```cpp
void(Time::*p2)();//定义p2为指向Time类中公用成员函数的指针变量
p2=&Time::get_time;//p2指向Time类公用成员函数get_time的入口地址
```

二者也可以合并：

```cpp
void(Time::*p2)()=&Time::get_time;
```

-注意：成员函数入口地址 &后是类名而不是对象名！



#### 用对象指针方法输出时分秒

```cpp
#include<iostream>
using namespace std;
class Time
{
public:
    Time(int,int,int);
    int hour;
    int minute;
    int sec;
    void get_time();
};
Time::Time(int h,int m,int s)
{
    hour=h;
    minute=m;
    sec=s;
}
void Time::get_time()
{
    cout<<hour<<":"<<minute<<":"<<sec<<endl;
}
int main()
{
    Time t1(10,13,56);//定义Time类对象t1并初始化
    int *p1=&t1.hour;//定义指向整形数据的指针变量p1，并使p1指向t1.hour
    cout<<*p1<<endl;
    t1.get_time();//调用对象t1的公用成员函数get_time

    Time *p2=&t1;//定义指向Time类对象的指针变量p2，并使其指向对象t1
    p2->get_time();//调用p2所指对象的get_time函数

    void(Time::*p3)();//定义指向Time类公用成员函数的指针变量p3
    p3=&Time::get_time;//使p3指向Time类公用函数get_time
    (t1.*p3)();//调用对象t1中p3所指的成员函数，即t1.get_time();
    return 0;
}

```

#### 易错：

使p3指向公用函数

```cpp
p3=&Time::get_time;
```

这里get_time后无括号！！！

### 指向当前对象的this指针

###### //同一类中有n个不同对象调用同一函数的目标代码，如何确保引用的是指定对象的成员函数？

##### **this指针：指向本类对象，它的值是当前被调用的成员函数所在对象的起始地址

```cpp
int Box::volume()
{return height*width*length;}
```

C++把它处理为：

```cpp
int Box::volume(Box *this)
{return this->height*this->width*this->length;}
```

总结：

调用成员对象a的成员函数f=调用成员函数f时，使this指针指向对象a，从而访问a的成员
